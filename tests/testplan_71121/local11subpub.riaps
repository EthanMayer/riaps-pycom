// RIAPS Test for Local (single node) 1-to-1 (actor to actor) Publish/Subscribe Pattern
// This test implements the description of 7.1.1.2.1 Part 2 of the initial design test plan to meet Milestone 2.1.2.
// Part 2 starts the subscriber first and then one second later starts the publisher.

app Local11SubPub {
	// Message types used in the app
    message CurrentCount; 

    
	// Local Publisher component
    component CountPublisher {
      timer starter 1000; 					// Startup timer trigger to wake up publisher 1 sec after startup
      timer wakeup 1000; 					// Periodic timer trigger to wake up publisher every 1 sec
      pub newCount : CurrentCount ;			// Publish port for CurrentCount messages 
    }
    
    // Local Subscriber component
    component CountSubscriber {
      timer starter 1; 					    // Startup subscriber immediately
      sub newCount : CurrentCount ;			// Subscriber port to trigger component with CurrentCount messages
    }
    
    // Test Publisher Actor on a local node
    actor LocalNodePublisher {
       {
          publisher : CountPublisher; 		// publishes global message 'CurrentCount' 
       }
    }
    
    // Test Subscriber Actor on the same local node
    actor LocalNodeSubscriber {
       {
          subscriber : CountSubscriber;		// subscribes to 'CurrentCount' messages
       }
    }
}
